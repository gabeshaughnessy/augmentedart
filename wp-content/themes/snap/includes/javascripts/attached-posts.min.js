/*! 1.0.8 */
!function(a,b){function c(){function b(){c(),d(),f(),k(),m()}function c(){v.postChoosers=a(".snap-post-chooser"),v.placeholders=a(".snap-attached-posts"),v.searchFields=a(".snap-apa-input"),v.pageTemplateSelect=a("#page_template"),v.portfolioWrapper=a("#snap_portfolio_posts"),v.homepageWrapper=a("#snap_homepage_posts"),v.homepageMBToggle=a("#snap_homepage_posts-hide"),v.portfolioMBToggle=a("#snap_portfolio_posts-hide"),t=snapData}function d(){v.postChoosers.on("click","a.tab-link",function(a){e(this),a.preventDefault()}),v.postChoosers.on("click","a.snap-recent-post",function(b){var c=a(this),d=c.attr("data-id"),e=c.attr("data-title");h(e,d,"link",this),b.preventDefault()}),v.placeholders.on("click",".snap-remove-item",function(a){i(this),a.preventDefault()}),v.pageTemplateSelect.on("change",m)}function e(b){var c=a(b),d=c.parents(".snap-post-chooser"),e=a(c.attr("href"),d),f=a(".tabs-panel",d);c.parent().addClass("tabs").siblings("li").removeClass("tabs"),f.removeClass("snap-active-tab").addClass("snap-inactive-tab"),e.addClass("snap-active-tab").removeClass("snap-inactive-tab")}function f(){v.searchFields.autocomplete({minLength:3,position:{collision:"fit"},source:function(a,b){var c=a.term;if(c in u)return b(u[c]),void 0;g(a,b,c,t)},focus:function(b,c){return a(this).val(c.item.label),!1},select:function(b,c){a(this).val(""),h(c.item.label,c.item.value,"select",this),b.preventDefault()}})}function g(b,c,d,e){return a.ajax({url:ajaxurl,type:"POST",data:{snap_apa_term:d,snap_apa_template:s(),snap_apa_nonce:e.nonce,action:e.action},dataType:"json",success:function(a){u[d]=a,c(a)}})}function h(b,c,d,e){var f=a(e),g=f.parents(".postbox"),h=g.attr("id"),i=a(".snap-attached-posts",g),k=a(".snap-current-posts",g),l=r(k);if(-1===a.inArray(String(c),l)){var m=j(h,c,b);i.prepend(m),l.unshift(c),q(k,o(l)),a(".snap-no-posts",g).hide()}}function i(b){var c=a(b),d=c.parent(),e=d.attr("data-id"),f=c.parents(".postbox"),g=a(".snap-current-posts",f),h=r(g),i=a.inArray(String(e),h);h.splice(i,1),g.val(o(h)),d.fadeOut(300,function(){a(this).remove(),0===a(".snap-attached-posts li",f).length&&a(".snap-no-posts",f).show()})}function j(a,b,c){return'<li id="'+a+"-"+b+'" data-id="'+b+'">'+c+' <a title="'+t.removePostsTitleAttr+'" class="snap-remove-item" href="#">'+t.removePostsLinkText+"</a></li>"}function k(){v.placeholders.sortable({placeholder:"snap-attached-posts-sortable-placeholder",forcePlaceholderSize:!0,cursor:"move",stop:function(a,b){l(a,b,this)}})}function l(b,c,d){var e=[],f=a(d),g=f.parents(".postbox"),h=a(".snap-current-posts",g);a(".snap-attached-posts li",g).each(function(){e.push(a(this).attr("data-id"))}),q(h,e)}function m(){"homepage.php"===s()?(v.homepageWrapper.show(),v.portfolioWrapper.hide()):"portfolio.php"===s()?(v.portfolioWrapper.show(),v.homepageWrapper.hide()):(v.portfolioWrapper.hide(),v.homepageWrapper.hide())}function n(a){return a.split(",")}function o(a){return a.join(",")}function p(a){return a.val()}function q(a,b){return a.val(b)}function r(a){return n(p(a))}function s(){return v.pageTemplateSelect.val()}var t,u={},v={};b()}b.SnapAttachedPosts=new c}(jQuery,window);